≤
YC:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\API\RequestHandler.cs
	namespace		 	
GreeniumCore		
 
.		 
API		 
{		 
public

 

static

 
class

 
RequestHandler

 &
{

& '
private 
static 
readonly 

HttpClient  *
Client+ 1
=2 3
new4 7

HttpClient8 B
(B C
)C D
;D E
public 
static 
async 
Task  
<  !
String! '
>' (
Call) -
(- .
String. 4
address5 <
,< =
String> D
methodE K
,K L

DictionaryM W
<W X
StringX ^
,^ _
String` f
>f g
headersh o
,o p

Dictionaryq {
<{ |
String	| Ç
,
Ç É
String
Ñ ä
>
ä ã
	getParams
å ï
,
ï ñ
Object
ó ù

postParams
û ®
)
® ©
{
™ ´
if 
( 
method 
. 
ToLower 
( 
)  
.  !
Equals! '
(' (
$str( -
)- .
). /
{/ 0
var 
finalAddress  
=! "
address# *
++ ,
$str- 0
;0 1
if 
( 
	getParams 
!=  
null! %
)% &
{& '
finalAddress  
=! "
	getParams# ,
., -
	Aggregate- 6
(6 7
finalAddress7 C
,C D
( 
current  
,  !
pair" &
)& '
=>( *
current+ 2
+3 4
(5 6
pair6 :
.: ;
Key; >
+? @
$strA D
+E F
pairG K
.K L
ValueL Q
+R S
$strT W
)W X
)X Y
;Y Z
finalAddress  
=! "
finalAddress# /
./ 0
Remove0 6
(6 7
finalAddress7 C
.C D
LastIndexOfD O
(O P
$strP S
)S T
)T U
;U V
} 
var 
response 
= 
await $
Client% +
.+ ,
GetAsync, 4
(4 5
finalAddress5 A
)A B
;B C
return 
await 
response %
.% &
Content& -
.- .
ReadAsStringAsync. ?
(? @
)@ A
;A B
} 
else 
{ 
var 
response 
= 
await $
Client% +
.+ ,
	PostAsync, 5
(5 6
address6 =
,= >
new 
StringContent %
(% &
JsonConvert& 1
.1 2
SerializeObject2 A
(A B

postParamsB L
)L M
,M N
EncodingO W
.W X
UTF8X \
,\ ]
$str^ p
)p q
)q r
;r s
return 
await 
response %
.% &
Content& -
.- .
ReadAsStringAsync. ?
(? @
)@ A
;A B
} 
} 	
}   
}!! ›
YC:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\API\SessionWrapper.cs
	namespace 	
GreeniumCore
 
. 
API 
{		 
public

 

class

 
SessionWrapper

 
{ 
private 
String 
SavedUsername $
{% &
get' *
;* +
set, /
;/ 0
}1 2
private 
String 
ConnectionToken &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
bool 
NotificationPooler &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
SessionWrapper 
( 
) 
{ 	
} 	
public 
SessionWrapper 
( 
String $
Username% -
,- .
String/ 5
Password6 >
,> ?
String@ F
TokenG L
,L M
boolN R
AutologS Z
=[ \
false] b
)b c
{ 	
ConnectionToken 
= 
Token #
;# $
SavedUsername 
= 
Username $
;$ %
} 	
public!! 
async!! 
System!! 
.!! 
	Threading!! %
.!!% &
Tasks!!& +
.!!+ ,
Task!!, 0
<!!0 1
bool!!1 5
>!!5 6

LogInAsync!!7 A
(!!A B
)!!B C
{"" 	
try## 
{$$ 
var%% 
jsonUser%% 
=%% 
await%% $
RequestHandler%%% 3
.%%3 4
Call%%4 8
(%%8 9
$str%%9 i
,%%i j
$str%%k q
,%%q r
null%%s w
,%%w x
null&& 
,&& 
new'' 
{'' 
Username'' !
=''" #
SavedUsername''$ 1
,''1 2
Token''3 8
=''9 :
ConnectionToken''; J
}''J K
)''K L
;''L M
var)) 
userObj)) 
=)) 
JsonConvert)) )
.))) *
DeserializeObject))* ;
<)); <
dynamic))< C
>))C D
())D E
jsonUser))E M
)))M N
;))N O
jsonUser** 
=** 
JsonConvert** &
.**& '
SerializeObject**' 6
(**6 7
userObj**7 >
.**> ?
LogInResult**? J
)**J K
;**K L
return,, 
true,, 
;,, 
}-- 
catch.. 
(.. 
	Exception.. 
e.. 
).. 
{// 
Console00 
.00 
	WriteLine00 !
(00! "
e00" #
)00# $
;00$ %
return11 
false11 
;11 
}22 
}33 	
}55 
}66 Í
tC:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\FileTracker\Exception\UnsupportedTagException.cs
	namespace 	
GreeniumCore
 
. 
FileTracker "
." #
FileTracker# .
.. /
	Exception/ 8
{8 9
public 

class #
UnsupportedTagException (
:) *
System+ 1
.1 2
	Exception2 ;
{; <
} 
}		 –+
dC:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\FileTracker\XmlConfigProvider.cs
	namespace 	
GreeniumCore
 
. 
FileTracker "
." #
FileTracker# .
{		 
public

 

class

 
XmlConfigProvider

 "
:

# $
XmlProvider

% 0
{

1 2
public 
XmlConfigProvider  
(  !
string! '
src( +
)+ ,
:- .
base/ 3
(3 4
src4 7
)7 8
{ 	
} 	
public 
XmlConfigProvider  
(  !
String! '
src( +
,+ ,
String- 3
trackedFile4 ?
)? @
:A B
baseC G
(G H
srcH K
)K L
{ 	

FileParser 
= 
$str #
;$ %
TrackedFile 
= 
trackedFile %
;% &

KnownNodes 
= 
new 

Dictionary '
<' (
int( +
,+ ,
string- 3
[3 4
]4 5
>5 6
(6 7
)7 8
{9 :
{ 
$num 
, 
new 
string #
[# $
]$ %
{% &
$str& ,
}, -
}- .
,. /
{ 
$num 
, 
new 
string #
[# $
]$ %
{% &
$str& 3
,3 4
$str5 >
}> ?
}? @
,@ A
{ 
$num 
, 
new 
string #
[# $
]$ %
{% &
$str& *
,* +
$str, :
}: ;
}; <
,< =
{ 
$num 
, 
new 
string #
[# $
]$ %
{% &
$str& +
,+ ,
$str- 3
}3 4
}4 5
} 
; 
} 	
public 
bool 
AddNode 
( 
String "
uid# &
,& '
String( .
name/ 3
)3 4
{ 	
var   

newComment   
=   
new    
XmlElementProvider  ! 3
(  3 4
)  4 5
{  5 6
Key!! 
=!! 
$str!! 
,!! 
Value"" 
="" 
$str"" 
,"" 

Attributes## 
=## 
new##  
List##! %
<##% &

XAttribute##& 0
>##0 1
(##1 2
)##2 3
{##4 5
new##5 8

XAttribute##9 C
(##C D
$str##D H
,##H I
Guid##J N
.##N O
NewGuid##O V
(##V W
)##W X
.##X Y
ToString##Y a
(##a b
)##b c
)##c d
}##d e
,##e f
Children%% 
=%% 
new%% 
List%% #
<%%# $
XmlElementProvider%%$ 6
>%%6 7
(%%7 8
)%%8 9
{&& 
new'' 
XmlElementProvider'' *
(''* +
)''+ ,
{(( 
Key)) 
=)) 
$str)) #
,))# $
Value** 
=** 
uid**  #
}++ 
,++ 
new-- 
XmlElementProvider-- *
(--* +
)--+ ,
{.. 
Key// 
=// 
$str// $
,//$ %
Value00 
=00 
name00  $
}11 
}22 
}44 
;44 
return66 
AddNode66 
(66 
$str66 (
,66( )

newComment66* 4
)664 5
;665 6
}77 	
public99 
bool99 
DeleteComment99 !
(99! "
String99" (
id99) +
)99+ ,
{:: 	
return;; 

DeleteNode;; 
(;; 
id;;  
,;;  !
$str;;" &
);;& '
;;;' (
}<< 	
public>> 
IEnumerable>> 
<>> 
string>> !
>>>! "
ReadIdentifiers>># 2
(>>2 3
)>>3 4
{?? 	
return@@ 
ReadNode@@ 
(@@ 
$str@@ )
)@@) *
.@@* +
Any@@+ .
(@@. /
)@@/ 0
?@@1 2
ReadNode@@3 ;
(@@; <
$str@@< I
)@@I J
.@@J K
Reverse@@K R
(@@R S
)@@S T
.@@T U
Select@@U [
(@@[ \
comment@@\ c
=>@@d f
$"@@g i
{@@i j
comment@@j q
.@@q r
Children@@r z
[@@z {
$num@@{ |
]@@| }
.@@} ~
Value	@@~ É
.
@@É Ñ
ToString
@@Ñ å
(
@@å ç
)
@@ç é
}
@@é è
;
@@è ê
{
@@ê ë
comment
@@ë ò
.
@@ò ô
Children
@@ô °
[
@@° ¢
$num
@@¢ £
]
@@£ §
.
@@§ •
Value
@@• ™
.
@@™ ´
ToString
@@´ ≥
(
@@≥ ¥
)
@@¥ µ
}
@@µ ∂
"
@@∂ ∑
)
@@∑ ∏
:
@@π ∫
new
@@ª æ
List
@@ø √
<
@@√ ƒ
string
@@ƒ  
>
@@  À
(
@@À Ã
)
@@Ã Õ
;
@@Õ Œ
}AA 	
}CC 
}DD ü
dC:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\FileTracker\XmlConcurrentList.cs
	namespace 	
GreeniumCore
 
. 
FileTracker "
." #
FileTracker# .
{ 
public 

class 
XmlConcurrentList "
<" #
T# $
>$ %
{% &
private		 
readonly		 
List		 
<		 
T		  
>		  !
_list		" '
=		( )
new		* -
List		. 2
<		2 3
T		3 4
>		4 5
(		5 6
)		6 7
;		7 8
private

 
readonly

 
object

 
_sync

  %
=

& '
new

( +
object

, 2
(

2 3
)

3 4
;

4 5
public 
void 
Add 
( 
T 
value 
)  
{! "
lock 
( 
_sync 
) 
_list 
. 
Add 
( 
value 
)  
;  !
} 	
public 
T 
Find 
( 
	Predicate 
<  
T  !
>! "
	predicate# ,
), -
{ 	
lock 
( 
_sync 
) 
return 
_list 
. 
Find !
(! "
	predicate" +
)+ ,
;, -
} 	
public 
int 
Remove 
( 
	Predicate #
<# $
T$ %
>% &
	predicate' 0
)0 1
{1 2
lock 
( 
_sync 
) 
return 
_list 
. 
	RemoveAll &
(& '
	predicate' 0
)0 1
;1 2
} 	
public 
T 
FirstOrDefault 
(  
)  !
{ 	
lock   
(   
_sync   
)   
return!! 
_list!! 
.!! 
FirstOrDefault!! +
(!!+ ,
)!!, -
;!!- .
}"" 	
public$$ 
List$$ 
<$$ 
T$$ 
>$$ 
ToList$$ 
($$ 
)$$ 
{%% 	
List&& 
<&& 
T&& 
>&& 
Result&& 
=&& 
new&&  
List&&! %
<&&% &
T&&& '
>&&' (
(&&( )
)&&) *
;&&* +
lock'' 
('' 
_sync'' 
)'' 
{(( 
foreach)) 
()) 
var)) 
element)) $
in))% '
_list))( -
)))- .
Result** 
.** 
Add** 
(** 
element** &
)**& '
;**' (
}++ 
return,, 
Result,, 
;,, 
}-- 	
}.. 
}// «)
eC:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\FileTracker\XmlElementProvider.cs
	namespace 	
GreeniumCore
 
. 
FileTracker "
." #
FileTracker# .
{. /
public		 

class		 
XmlElementProvider		 #
{		# $
public

 
String

 
Key

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 
Object 
Value 
{ 
get !
;! "
set# &
;& '
}( )
public 
List 
< 
XmlElementProvider &
>& '
Children( 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
List 
< 

XAttribute 
> 

Attributes  *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
XmlElementProvider !
(! "
)" #
{# $
Children 
= 
new 
List 
<  
XmlElementProvider  2
>2 3
(3 4
)4 5
;5 6

Attributes 
= 
new 
List !
<! "

XAttribute" ,
>, -
(- .
). /
;/ 0
} 	
public 
static 
XElement '
Recursive_ConvertToXElement :
(: ;
XmlElementProvider; M
originalNodeN Z
)Z [
{[ \
if 
( 
originalNode 
. 
Key  
==! #
null$ (
&&) +
!, -
originalNode- 9
.9 :
Key: =
.= >
Trim> B
(B C
)C D
.D E
AnyE H
(H I
)I J
&&K M
originalNodeN Z
.Z [
Value[ `
==a c
nulld h
)h i
return 
null 
; 
var 
xElement 
= 
new 
XElement '
(' (
originalNode( 4
.4 5
Key5 8
,8 9
originalNode: F
.F G
ValueG L
,L M
originalNodeN Z
.Z [

Attributes[ e
)e f
;f g
if 
( 
originalNode 
. 
Children %
.% &
Any& )
() *
)* +
)+ ,
foreach 
( 
var 
node !
in" $
originalNode% 1
.1 2
Children2 :
): ;
xElement 
. 
Add  
(  !'
Recursive_ConvertToXElement! <
(< =
node= A
)A B
)B C
;C D
return 
xElement 
; 
} 	
public!! 
static!! 
XmlElementProvider!! ((
Recursive_XmlElementProvider!!) E
(!!E F
XElement!!F N
originalNode!!O [
,!![ \
bool!!] a
isRoot!!b h
=!!i j
true!!k o
)!!o p
{"" 	
if$$ 
($$ 
originalNode$$ 
==$$ 
null$$  $
)$$$ %
return%% 
null%% 
;%% 
var'' 
xElement'' 
='' 
new'' 
XmlElementProvider'' 1
(''1 2
)''2 3
{''3 4
Key(( 
=(( 
originalNode(( "
.((" #
Name((# '
.((' (
ToString((( 0
(((0 1
)((1 2
,((2 3
Value)) 
=)) 
!)) 
isRoot)) 
?))  !
originalNode))" .
.)). /
Value))/ 4
:))5 6
$str))7 9
,))9 :

Attributes** 
=** 
originalNode** )
.**) *

Attributes*** 4
(**4 5
)**5 6
.**6 7
ToList**7 =
(**= >
)**> ?
,**? @
Children++ 
=++ 
new++ 
List++ #
<++# $
XmlElementProvider++$ 6
>++6 7
(++7 8
)++8 9
},, 
;,, 
if.. 
(.. 
originalNode.. 
... 
Nodes.. !
(..! "
).." #
...# $
Any..$ '
(..' (
)..( )
)..) *
foreach// 
(// 
var// 
node//  
in//! #
originalNode//$ 0
.//0 1
Elements//1 9
(//9 :
)//: ;
)//; <
xElement00 
.00 
Children00 %
.00% &
Add00& )
(00) *(
Recursive_XmlElementProvider00* F
(00F G
node00G K
,00K L
false00M R
)00R S
)00S T
;00T U
return22 
xElement22 
;22 
}33 	
}44 
}55 π∆
^C:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\FileTracker\XmlProvider.cs
	namespace 	
GreeniumCore
 
. 
FileTracker "
." #
FileTracker# .
{ 
public 

class 
XmlProvider 
: 
IDisposable *
{ 
public 
String 

SourcePath  
{! "
get# &
;& '
	protected( 1
set2 5
;5 6
}7 8
	protected 
String 

FileParser #
{$ %
get& )
;) *
set+ .
;. /
}0 1
	protected 
String 
TrackedFile $
{% &
get' *
;* +
set, /
;/ 0
}1 2
	protected 
String 
AbsoluteFile %
=>& (

SourcePath) 3
+4 5
String6 <
.< =
Format= C
(C D

FileParserD N
,N O
TrackedFileP [
)[ \
+] ^
$str_ e
;e f
public 
readonly 
static 
short $
XDocumentLimit% 3
=4 5
$num6 8
;8 9
public## 
	XDocument## 
OpenedDocument## '
{##( )
get##* -
;##- .
	protected##/ 8
set##9 <
;##< =
}##> ?
	protected$$ 
	XDocument$$ 
Rollback$$ $
{$$% &
get$$' *
;$$* +
set$$, /
;$$/ 0
}$$1 2
	protected(( 
HashSet(( 
<(( 
String((  
>((  !

CachedTags((" ,
{((- .
get((/ 2
;((2 3
set((4 7
;((7 8
}((9 :
	protected)) 

Dictionary)) 
<)) 
int))  
,))  !
String))" (
[))( )
]))) *
>))* +

KnownNodes)), 6
{))7 8
get))9 <
;))< =
set))> A
;))A B
}))C D
public,, 
XmlProvider,, 
(,, 
String,, !
src,," %
),,% &
{-- 	

SourcePath.. 
=.. 
src.. 
;.. 

CachedTags// 
=// 
new// 
HashSet// $
<//$ %
String//% +
>//+ ,
(//, -
)//- .
;//. /
}00 	
public22 
XmlProvider22 
(22 
String22 !
src22" %
,22% &
String22' -

parserType22. 8
)228 9
:22: ;
this22< @
(22@ A
src22A D
)22D E
{33 	

FileParser44 
=44 

parserType44 #
;44# $
}55 	
public77 
XmlProvider77 
(77 
String77 !
src77" %
,77% &
String77' -

parserType77. 8
,778 9
String77: @
trackedFile77A L
)77L M
:77N O
this77P T
(77T U
src77U X
,77X Y

parserType77Z d
)77d e
{88 	
TrackedFile99 
=99 
trackedFile99 %
;99% &
}:: 	
public<< 
XmlProvider<< 
(<< 
String<< !
src<<" %
,<<% &
String<<' -

parserType<<. 8
,<<8 9
String<<: @
trackedFile<<A L
,<<L M

Dictionary<<N X
<<<X Y
int<<Y \
,<<\ ]
String<<^ d
[<<d e
]<<e f
><<f g
tags<<h l
)<<l m
:<<n o
this<<p t
(<<t u
src<<u x
,<<x y

parserType	<<z Ñ
,
<<Ñ Ö
trackedFile
<<Ü ë
)
<<ë í
{== 	

KnownNodes>> 
=>> 
tags>> 
;>> 
}?? 	
publicAA 
boolAA 

FileExistsAA 
(AA 
)AA  
{BB 	
returnCC 
FileCC 
.CC 
ExistsCC 
(CC 
AbsoluteFileCC +
)CC+ ,
;CC, -
}DD 	
publicFF 
	XDocumentFF 
OpenFileFF !
(FF! "
StringFF" (
trackedFileFF) 4
=FF5 6
nullFF7 ;
)FF; <
{GG 	
	CloseFileHH 
(HH 
)HH 
;HH 
ifJJ 
(JJ 
trackedFileJJ 
!=JJ 
nullJJ #
)JJ# $
TrackedFileKK 
=KK 
trackedFileKK )
;KK) *
ifMM 
(MM 
!MM 
FileMM 
.MM 
ExistsMM 
(MM 
AbsoluteFileMM )
)MM) *
)MM* +
{NN 
OpenedDocumentOO 
=OO  
newOO! $
	XDocumentOO% .
(OO. /
)OO/ 0
;OO0 1
AddNodePP 
(PP 
nullPP 
)PP 
;PP 
returnQQ 
OpenedDocumentQQ %
;QQ% &
}RR 
returnSS 
OpenedDocumentSS !
=SS" #
	XDocumentSS$ -
.SS- .
LoadSS. 2
(SS2 3
AbsoluteFileSS3 ?
)SS? @
;SS@ A
}TT 	
publicVV 
virtualVV 
voidVV 
	CloseFileVV %
(VV% &
)VV& '
{VV( )
OpenedDocumentWW 
=WW 
RollbackWW %
=WW& '
nullWW( ,
;WW, -
}XX 	
publicZZ 
voidZZ 
SaveFileZZ 
(ZZ 
)ZZ 
{[[ 	
OpenedDocument]] 
.]] 
Save]] 
(]]  
AbsoluteFile]]  ,
)]], -
;]]- .
Rollback^^ 
=^^ 
OpenedDocument^^ %
;^^% &
}__ 	
publicaa 
virtualaa 
boolaa 

DeleteNodeaa &
(aa& '
Stringaa' -
keyaa. 1
,aa1 2
Stringaa3 9
tagaa: =
,aa= >
Stringaa? E
valueaaF K
)aaK L
{bb 	
trycc 
{dd 
OpenedDocumentee 
.ee 
Descendantsee *
(ee* +
keyee+ .
)ee. /
.ff 
Whereff 
(ff 
nff 
=>ff 
(ff  !
(ff! "
stringff" (
)ff( )
nff) *
.ff* +
Elementff+ 2
(ff2 3
tagff3 6
)ff6 7
)ff7 8
.ff8 9
Equalsff9 ?
(ff? @
valueff@ E
)ffE F
)ffF G
.gg 
Removegg 
(gg 
)gg 
;gg 
SaveFileii 
(ii 
)ii 
;ii 
returnjj 
truejj 
;jj 
}kk 
catchll 
{mm 
OpenedDocumentnn 
=nn  
Rollbacknn! )
;nn) *
returnoo 
falseoo 
;oo 
}pp 
}qq 	
publicss 
virtualss 
boolss 
AddNodess #
(ss# $
Stringss$ *
keyss+ .
,ss. /
paramsss0 6
XmlElementProviderss7 I
[ssI J
]ssJ K
datassL P
)ssP Q
{tt 	
tryuu 
{vv 
Listww 
<ww 
XElementww 
>ww 
xmlDataww &
=ww' (
newww) ,
Listww- 1
<ww1 2
XElementww2 :
>ww: ;
(ww; <
)ww< =
;ww= >
ifyy 
(yy 
datayy 
.yy 
Anyyy 
(yy 
)yy 
)yy 
xmlDatazz 
.zz 
AddRangezz $
(zz$ %
data{{ 
.{{ 
Select{{ #
({{# $
XmlElementProvider{{$ 6
.{{6 7'
Recursive_ConvertToXElement{{7 R
){{R S
)|| 
;|| 
if~~ 
(~~ 
OpenedDocument~~ "
.~~" #
Root~~# '
==~~( *
null~~+ /
)~~/ 0
OpenedDocument "
." #
Add# &
(& '
new' *
XElement+ 3
(3 4
$str4 :
,: ;
OpenedDocument< J
.J K
RootK O
)O P
)P Q
;Q R
SaveFile
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
if
ÉÉ 
(
ÉÉ 
key
ÉÉ 
==
ÉÉ 
null
ÉÉ 
)
ÉÉ  
{
ÑÑ 
OpenedDocument
ÖÖ "
.
ÖÖ" #
Root
ÖÖ# '
.
ÖÖ' (
Add
ÖÖ( +
(
ÖÖ+ ,
xmlData
ÖÖ, 3
)
ÖÖ3 4
;
ÖÖ4 5
}
ÜÜ 
else
áá 
{
àà 
if
ää 
(
ää 
!
ää 
OpenedDocument
ää '
.
ää' (
Descendants
ää( 3
(
ää3 4
key
ää4 7
)
ää7 8
.
ää8 9
Any
ää9 <
(
ää< =
)
ää= >
)
ää> ?
OpenedDocument
ãã &
.
ãã& '
Root
ãã' +
.
ãã+ ,
Add
ãã, /
(
ãã/ 0
new
ãã0 3
XElement
ãã4 <
(
ãã< =
key
ãã= @
,
ãã@ A
xmlData
ããB I
)
ããI J
)
ããJ K
;
ããK L
else
åå 
OpenedDocument
çç &
.
çç& '
Descendants
çç' 2
(
çç2 3
key
çç3 6
)
çç6 7
.
çç7 8
FirstOrDefault
çç8 F
(
ççF G
)
ççG H
.
ççH I
Add
ççI L
(
ççL M
xmlData
ççM T
)
ççT U
;
ççU V
}
éé 
SaveFile
êê 
(
êê 
)
êê 
;
êê 
return
ëë 
true
ëë 
;
ëë 
}
íí 
catch
ìì 
{
îî 
OpenedDocument
ïï 
=
ïï  
Rollback
ïï! )
;
ïï) *
return
ññ 
false
ññ 
;
ññ 
}
óó 
}
òò 	
public
öö 
virtual
öö 
IEnumerable
öö "
<
öö" # 
XmlElementProvider
öö# 5
>
öö5 6
ReadNode
öö7 ?
(
öö? @
String
öö@ F
key
ööG J
)
ööJ K
{
õõ 	
if
úú 
(
úú 
OpenedDocument
úú 
?
úú 
.
úú  
Root
úú  $
==
úú% '
null
úú( ,
)
úú, -
return
úú. 4
new
úú5 8
List
úú9 =
<
úú= > 
XmlElementProvider
úú> P
>
úúP Q
(
úúQ R
)
úúR S
;
úúS T
var
ùù 
comments
ùù 
=
ùù 
OpenedDocument
ùù )
.
ùù) *
Descendants
ùù* 5
(
ùù5 6
key
ùù6 9
)
ùù9 :
.
ùù: ;
Elements
ùù; C
(
ùùC D
)
ùùD E
;
ùùE F
return
†† 
!
†† 
comments
†† 
.
†† 
Any
††  
(
††  !
)
††! "
?
††# $
new
°° 
List
°° 
<
°°  
XmlElementProvider
°° +
>
°°+ ,
(
°°, -
)
°°- .
:
°°/ 0
comments
¢¢ 
.
¢¢ 
Select
¢¢ 
(
¢¢  
node
¢¢  $
=>
¢¢% ' 
XmlElementProvider
¢¢( :
.
¢¢: ;*
Recursive_XmlElementProvider
¢¢; W
(
¢¢W X
node
¢¢X \
)
¢¢\ ]
)
¢¢] ^
;
¢¢^ _
}
££ 	
public
¶¶ 
virtual
¶¶ 
bool
¶¶ 

InsertNode
¶¶ &
(
¶¶& '
String
¶¶' -
Id
¶¶. 0
,
¶¶0 1
String
¶¶2 8
key
¶¶9 <
,
¶¶< =
params
¶¶> D 
XmlElementProvider
¶¶E W
[
¶¶W X
]
¶¶X Y
data
¶¶Z ^
)
¶¶^ _
{
ßß 	
try
®® 
{
©© 
(
™™ 
OpenedDocument
™™ 
.
™™  
Descendants
™™  +
(
™™+ ,
key
™™, /
)
™™/ 0
)
™™0 1
.
´´ 
SingleOrDefault
´´ $
(
´´$ %
idAttr
´´% +
=>
´´, .
(
´´/ 0
(
´´0 1
String
´´1 7
)
´´7 8
idAttr
´´8 >
.
´´> ?
	Attribute
´´? H
(
´´H I
$str
´´I M
)
´´M N
)
´´N O
.
´´O P
Equals
´´P V
(
´´V W
Id
´´W Y
)
´´Y Z
)
´´Z [
?
´´[ \
.
¨¨ 
AddAfterSelf
¨¨ !
(
¨¨! "
data
¨¨" &
.
¨¨& '
Select
¨¨' -
(
¨¨- . 
XmlElementProvider
¨¨. @
.
¨¨@ A)
Recursive_ConvertToXElement
¨¨A \
)
¨¨\ ]
)
¨¨] ^
;
¨¨^ _
SaveFile
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
return
ØØ 
true
ØØ 
;
ØØ 
}
∞∞ 
catch
±± 
{
≤≤ 
OpenedDocument
≥≥ 
=
≥≥  
Rollback
≥≥! )
;
≥≥) *
return
¥¥ 
false
¥¥ 
;
¥¥ 
}
µµ 
}
∂∂ 	
public
∏∏ 
virtual
∏∏ 
bool
∏∏ 

DeleteFile
∏∏ &
(
∏∏& '
)
∏∏' (
{
ππ 	
try
∫∫ 
{
ªª 
	CloseFile
ºº 
(
ºº 
)
ºº 
;
ºº 
File
ΩΩ 
.
ΩΩ 
Delete
ΩΩ 
(
ΩΩ 
AbsoluteFile
ΩΩ (
)
ΩΩ( )
;
ΩΩ) *
return
ææ 
true
ææ 
;
ææ 
}
øø 
catch
¿¿ 
{
¡¡ 
return
¬¬ 
false
¬¬ 
;
¬¬ 
}
√√ 
}
ƒƒ 	
public
∆∆ 
virtual
∆∆ 
IEnumerable
∆∆ "
<
∆∆" #

XContainer
∆∆# -
>
∆∆- .
GetNodes
∆∆/ 7
(
∆∆7 8
String
∆∆8 >
key
∆∆? B
)
∆∆B C
{
∆∆C D
try
«« 
{
«« 
return
»» 
OpenedDocument
»» %
.
»»% &
Elements
»»& .
(
»». /
key
»»/ 2
)
»»2 3
;
»»3 4
}
…… 
catch
   
{
ÀÀ 
return
ÃÃ 
new
ÃÃ 
List
ÃÃ 
<
ÃÃ  

XContainer
ÃÃ  *
>
ÃÃ* +
(
ÃÃ+ ,
)
ÃÃ, -
;
ÃÃ- .
}
ÕÕ 
}
ŒŒ 	
public
–– 
virtual
–– 
IEnumerable
–– "
<
––" #
bool
––# '
>
––' (!
UpdateMultipleNodes
––) <
(
––< =
String
––= C
Id
––D F
,
––F G
String
––H N
Key
––O R
,
––R S

Dictionary
––T ^
<
––^ _
String
––_ e
,
––e f
String
––g m
>
––m n
data
––o s
,
––s t
bool
––u y

LineChange––z Ñ
=––Ö Ü
false––á å
)––å ç
{
—— 	
var
““ 
result
““ 
=
““ 
data
““ 
.
““ 
Select
““ $
(
““$ %
pair
““% )
=>
““* ,

UpdateNode
““- 7
(
““7 8
Id
““8 :
,
““: ;
Key
““< ?
,
““? @
pair
““A E
.
““E F
Key
““F I
,
““I J
pair
““K O
.
““O P
Value
““P U
,
““U V

LineChange
““W a
)
““a b
)
““b c
;
““c d
if
”” 
(
”” 
!
”” 

LineChange
”” 
)
”” 
SaveFile
‘‘ 
(
‘‘ 
)
‘‘ 
;
‘‘ 
return
’’ 
result
’’ 
;
’’ 
}
÷÷ 	
public
ÿÿ 
virtual
ÿÿ 
bool
ÿÿ 

UpdateNode
ÿÿ &
(
ÿÿ& '
String
ÿÿ' -
Id
ÿÿ. 0
,
ÿÿ0 1
String
ÿÿ2 8
Key
ÿÿ9 <
,
ÿÿ< =
String
ÿÿ> D
Name
ÿÿE I
,
ÿÿI J
String
ÿÿK Q
NewValue
ÿÿR Z
,
ÿÿZ [
bool
ÿÿ\ `
SaveChanges
ÿÿa l
=
ÿÿm n
true
ÿÿo s
)
ÿÿs t
{
ŸŸ 	
try
⁄⁄ 
{
€€ 
var
›› 
MyNode
›› 
=
›› 
(
›› 
OpenedDocument
›› ,
.
››, -
Descendants
››- 8
(
››8 9
Key
››9 <
)
››< =
)
››= >
.
››> ?
SingleOrDefault
››? N
(
››N O
idAttr
››O U
=>
››V X
(
››Y Z
(
››Z [
String
››[ a
)
››a b
idAttr
››b h
.
››h i
	Attribute
››i r
(
››r s
$str
››s w
)
››w x
)
››x y
.
››y z
Equals››z Ä
(››Ä Å
Id››Å É
)››É Ñ
)››Ñ Ö
;››Ö Ü
MyNode
ﬁﬁ 
.
ﬁﬁ 
Element
ﬁﬁ 
(
ﬁﬁ 
Name
ﬁﬁ #
)
ﬁﬁ# $
.
ﬁﬁ$ %
Value
ﬁﬁ% *
=
ﬁﬁ+ ,
NewValue
ﬁﬁ- 5
;
ﬁﬁ5 6
if
‡‡ 
(
‡‡ 
SaveChanges
‡‡ 
)
‡‡  
SaveFile
·· 
(
·· 
)
·· 
;
·· 
return
‚‚ 
true
‚‚ 
;
‚‚ 
}
„„ 
catch
‰‰ 
{
ÂÂ 
OpenedDocument
ÊÊ 
=
ÊÊ  
Rollback
ÊÊ! )
;
ÊÊ) *
return
ÁÁ 
false
ÁÁ 
;
ÁÁ 
}
ËË 
}
ÈÈ 	
public
ÎÎ 
virtual
ÎÎ 
bool
ÎÎ 

DeleteNode
ÎÎ &
(
ÎÎ& '
String
ÎÎ' -
Id
ÎÎ. 0
,
ÎÎ0 1
String
ÎÎ2 8
Key
ÎÎ9 <
)
ÎÎ< =
{
ÏÏ 	
try
ÌÌ 
{
ÓÓ 
(
ÔÔ 
OpenedDocument
ÔÔ 
.
ÔÔ  
Descendants
ÔÔ  +
(
ÔÔ+ ,
Key
ÔÔ, /
)
ÔÔ/ 0
)
ÔÔ0 1
.
ÔÔ1 2
Where
ÔÔ2 7
(
ÔÔ7 8
idAttr
ÔÔ8 >
=>
ÔÔ? A
(
ÔÔB C
(
ÔÔC D
String
ÔÔD J
)
ÔÔJ K
idAttr
ÔÔK Q
.
ÔÔQ R
	Attribute
ÔÔR [
(
ÔÔ[ \
$str
ÔÔ\ `
)
ÔÔ` a
)
ÔÔa b
.
ÔÔb c
Equals
ÔÔc i
(
ÔÔi j
Id
ÔÔj l
)
ÔÔl m
)
ÔÔm n
.
ÔÔn o
Remove
ÔÔo u
(
ÔÔu v
)
ÔÔv w
;
ÔÔw x
SaveFile
ÒÒ 
(
ÒÒ 
)
ÒÒ 
;
ÒÒ 
return
ÚÚ 
true
ÚÚ 
;
ÚÚ 
}
ÛÛ 
catch
ÙÙ 
{
ÙÙ 
OpenedDocument
ıı 
=
ıı  
Rollback
ıı! )
;
ıı) *
return
ˆˆ 
false
ˆˆ 
;
ˆˆ 
}
˜˜ 
}
¯¯ 	
public
˙˙ 
virtual
˙˙ 
void
˙˙ 
CheckTag
˙˙ $
(
˙˙$ %
String
˙˙% +
tag
˙˙, /
)
˙˙/ 0
{
˚˚ 	
if
¸¸ 
(
¸¸ 
!
¸¸ 

CachedTags
¸¸ 
.
¸¸ 
Contains
¸¸ $
(
¸¸$ %
tag
¸¸% (
)
¸¸( )
&&
¸¸* ,
!
¸¸- .

KnownNodes
¸¸. 8
.
¸¸8 9
Values
¸¸9 ?
.
¸¸? @
Any
¸¸@ C
(
¸¸C D
tagArr
¸¸D J
=>
¸¸K M
tagArr
¸¸N T
.
¸¸T U
Contains
¸¸U ]
(
¸¸] ^
tag
¸¸^ a
)
¸¸a b
)
¸¸b c
)
¸¸c d
throw
˝˝ 
new
˝˝ %
UnsupportedTagException
˝˝ 1
(
˝˝1 2
)
˝˝2 3
;
˝˝3 4

CachedTags
ˇˇ 
.
ˇˇ 
Add
ˇˇ 
(
ˇˇ 
tag
ˇˇ 
)
ˇˇ 
;
ˇˇ  
}
ÅÅ 	
private
ÑÑ 
bool
ÑÑ 
disposedValue
ÑÑ "
=
ÑÑ# $
false
ÑÑ% *
;
ÑÑ* +
	protected
ÜÜ 
virtual
ÜÜ 
void
ÜÜ 
Dispose
ÜÜ &
(
ÜÜ& '
bool
ÜÜ' +
	disposing
ÜÜ, 5
)
ÜÜ5 6
{
áá 	
if
àà 
(
àà 
!
àà 
disposedValue
àà 
)
àà 
{
ââ 
if
ää 
(
ää 
	disposing
ää 
)
ää 
{
ãã 
SaveFile
åå 
(
åå 
)
åå 
;
åå 
	CloseFile
éé 
(
éé 
)
éé 
;
éé  

CachedTags
êê 
.
êê 
Clear
êê $
(
êê$ %
)
êê% &
;
êê& '

KnownNodes
ëë 
.
ëë 
Clear
ëë $
(
ëë$ %
)
ëë% &
;
ëë& '

CachedTags
ìì 
=
ìì  
null
ìì! %
;
ìì% &

KnownNodes
îî 
=
îî  
null
îî! %
;
îî% &
TrackedFile
ïï 
=
ïï  !
null
ïï" &
;
ïï& '

FileParser
ññ 
=
ññ  
null
ññ! %
;
ññ% &
}
óó 
disposedValue
öö 
=
öö 
true
öö  $
;
öö$ %
}
õõ 
}
úú 	
public
ûû 
void
ûû 
Dispose
ûû 
(
ûû 
)
ûû 
{
üü 	
Dispose
†† 
(
†† 
true
†† 
)
†† 
;
†† 
}
¢¢ 	
	protected
ßß 
static
ßß 
bool
ßß 
DictionaryEqual
ßß -
<
ßß- .
TKey
ßß. 2
,
ßß2 3
TValue
ßß4 :
>
ßß: ;
(
ßß; <
IDictionary
®® 
<
®® 
TKey
®® 
,
®® 
TValue
®® $
>
®®$ %
first
®®& +
,
®®+ ,
IDictionary
®®- 8
<
®®8 9
TKey
®®9 =
,
®®= >
TValue
®®? E
>
®®E F
second
®®G M
)
®®M N
{
©© 	
return
™™ 
DictionaryEqual
™™ "
(
™™" #
first
™™# (
,
™™( )
second
™™* 0
,
™™0 1
null
™™2 6
)
™™6 7
;
™™7 8
}
´´ 	
private
≠≠ 
static
≠≠ 
bool
≠≠ 
DictionaryEqual
≠≠ +
<
≠≠+ ,
TKey
≠≠, 0
,
≠≠0 1
TValue
≠≠2 8
>
≠≠8 9
(
≠≠9 :
IDictionary
ÆÆ 
<
ÆÆ 
TKey
ÆÆ 
,
ÆÆ 
TValue
ÆÆ $
>
ÆÆ$ %
first
ÆÆ& +
,
ÆÆ+ ,
IDictionary
ÆÆ- 8
<
ÆÆ8 9
TKey
ÆÆ9 =
,
ÆÆ= >
TValue
ÆÆ? E
>
ÆÆE F
second
ÆÆG M
,
ÆÆM N
IEqualityComparer
ØØ 
<
ØØ 
TValue
ØØ $
>
ØØ$ %
valueComparer
ØØ& 3
)
ØØ3 4
{
∞∞ 	
if
±± 
(
±± 
first
±± 
==
±± 
second
±± 
)
±±  
return
±±! '
true
±±( ,
;
±±, -
if
≤≤ 
(
≤≤ 
(
≤≤ 
first
≤≤ 
==
≤≤ 
null
≤≤ 
)
≤≤ 
||
≤≤  "
(
≤≤# $
second
≤≤$ *
==
≤≤+ -
null
≤≤. 2
)
≤≤2 3
)
≤≤3 4
return
≤≤5 ;
false
≤≤< A
;
≤≤A B
if
≥≥ 
(
≥≥ 
first
≥≥ 
.
≥≥ 
Count
≥≥ 
!=
≥≥ 
second
≥≥ %
.
≥≥% &
Count
≥≥& +
)
≥≥+ ,
return
≥≥- 3
false
≥≥4 9
;
≥≥9 :
valueComparer
µµ 
=
µµ 
valueComparer
µµ )
??
µµ* ,
EqualityComparer
µµ- =
<
µµ= >
TValue
µµ> D
>
µµD E
.
µµE F
Default
µµF M
;
µµM N
foreach
∑∑ 
(
∑∑ 
var
∑∑ 
kvp
∑∑ 
in
∑∑ 
first
∑∑  %
)
∑∑% &
{
∏∏ 
TValue
ππ 
secondValue
ππ "
;
ππ" #
if
ªª 
(
ªª 
!
ªª 
second
ªª 
.
ªª 
TryGetValue
ªª '
(
ªª' (
kvp
ªª( +
.
ªª+ ,
Key
ªª, /
,
ªª/ 0
out
ªª1 4
secondValue
ªª5 @
)
ªª@ A
)
ªªA B
return
ªªC I
false
ªªJ O
;
ªªO P
if
ºº 
(
ºº 
!
ºº 
secondValue
ºº  
.
ºº  !
GetType
ºº! (
(
ºº( )
)
ºº) *
.
ºº* +
IsArray
ºº+ 2
&&
ºº3 5
!
ºº6 7
valueComparer
ºº7 D
.
ººD E
Equals
ººE K
(
ººK L
kvp
ººL O
.
ººO P
Value
ººP U
,
ººU V
secondValue
ººW b
)
ººb c
)
ººc d
return
ººe k
false
ººl q
;
ººq r
}
ΩΩ 
return
ææ 
true
ææ 
;
ææ 
}
øø 	
}
¿¿ 
}¡¡ Ÿ&
MC:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\InMail.cs
	namespace 	
GreeniumCore
 
{ 
public 

class 
InMail 
{ 
private 
static 
string 
[ 
] 
Scopes  &
=' (
{) *
GmailService+ 7
.7 8
Scope8 =
.= >
GmailReadonly> K
}L M
;M N
private 
static 
string 
ApplicationName -
=. /
$str0 D
;D E
public 
long 
OutlookWeight !
(! "
string" (
username) 1
,1 2
string3 9
password: B
)B C
{ 	
var 
application 
= 
new !
Application" -
(- .
). /
;/ 0
	Microsoft 
. 
Office 
. 
Interop $
.$ %
Outlook% ,
., -
	NameSpace- 6
outlook7 >
=? @
applicationA L
.L M
GetNamespaceM Y
(Y Z
$strZ `
)` a
;a b
var 
defaultFolder 
= 
outlook  '
.' (
GetDefaultFolder( 8
(8 9
OlDefaultFolders9 I
.I J
olFolderInboxJ W
)W X
;X Y
defaultFolder 
. 
GetExplorer %
(% &
false& +
)+ ,
;, -
outlook 
. 
Logon 
( 
username "
," #
password$ ,
,, -
Missing. 5
.5 6
Value6 ;
,; <
Missing= D
.D E
ValueE J
)J K
;K L
long 
weight 
= 
defaultFolder '
.' (
Items( -
.- .
Count. 3
;3 4
outlook   
.   
Logoff   
(   
)   
;   
return!! 
weight!! 
*!! 
$num!! 
;!! 
}"" 	
public$$ 
long$$ 
GmailWeight$$ 
($$  
)$$  !
{$$! "
UserCredential%% 

credential%% %
;%%% &
using'' 
('' 
var'' 
stream'' 
='' 
new(( 

FileStream(( 
((( 
$str(( 7
,((7 8
FileMode((9 A
.((A B
Open((B F
,((F G

FileAccess((H R
.((R S
Read((S W
)((W X
)((X Y
{)) 
var** 
credPath** 
=** 
System** %
.**% &
Environment**& 1
.**1 2
GetFolderPath**2 ?
(**? @
System++ 
.++ 
Environment++ &
.++& '
SpecialFolder++' 4
.++4 5
Personal++5 =
)++= >
;++> ?
credPath,, 
=,, 
Path,, 
.,,  
Combine,,  '
(,,' (
credPath,,( 0
,,,0 1
$str,,2 R
),,R S
;,,S T

credential.. 
=.. (
GoogleWebAuthorizationBroker.. 9
...9 :
AuthorizeAsync..: H
(..H I
GoogleClientSecrets// '
.//' (
Load//( ,
(//, -
stream//- 3
)//3 4
.//4 5
Secrets//5 <
,//< =
Scopes00 
,00 
$str11 
,11 
CancellationToken22 %
.22% &
None22& *
,22* +
new33 
FileDataStore33 %
(33% &
credPath33& .
,33. /
true330 4
)334 5
)335 6
.336 7
Result337 =
;33= >
}55 
var88 
service88 
=88 
new88 
GmailService88 *
(88* +
new88+ .
BaseClientService88/ @
.88@ A
Initializer88A L
(88L M
)88M N
{88N O!
HttpClientInitializer99 %
=99& '

credential99( 2
,992 3
ApplicationName:: 
=::  !
ApplicationName::" 1
,::1 2
};; 
);; 
;;; 
return>> 
service>> 
.>> 
Users>>  
.>>  !
Messages>>! )
.>>) *
List>>* .
(>>. /
$str>>/ 3
)>>3 4
.>>4 5
Execute>>5 <
(>>< =
)>>= >
.>>> ?
Messages>>? G
.>>G H
Count>>H M
*>>N O
$num>>P R
;>>R S
}@@ 	
}BB 
}DD â
^C:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str '
)' (
]( )
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str )
)) *
]* +
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *ß
\C:\Users\macie\Source\Repos\Greenium\GreeniumPrototype\GreeniumCore\Security\UniqueSerial.cs
	namespace		 	
GreeniumCore		
 
.		 
Security		 
{		  !
public

 

static

 
class

 
UniqueSerial

 $
{

% &
[ 	
	DllImport	 
( 
$str !
)! "
]" #
private 
static 
extern 
long " 
GetVolumeInformation# 7
(7 8
string8 >
PathName? G
,G H
StringBuilderI V
VolumeNameBufferW g
,g h
UInt32i o
VolumeNameSizep ~
,~ 
ref
Ä É
UInt32
Ñ ä 
VolumeSerialNumber
ã ù
,
ù û
ref
ü ¢
UInt32
£ ©$
MaximumComponentLength
™ ¿
,
¿ ¡
ref
¬ ≈
UInt32
∆ Ã
FileSystemFlags
Õ ‹
,
‹ ›
StringBuilder
ﬁ Î"
FileSystemNameBuffer
Ï Ä
,
Ä Å
UInt32
Ç à 
FileSystemNameSize
â õ
)
õ ú
;
ú ù
public 
static 
string 
GetVolumeSerial ,
(, -
)- .
{ 	
var 
strDriveLetter 
=  
Path! %
.% &
GetPathRoot& 1
(1 2
Environment2 =
.= >
GetFolderPath> K
(K L
EnvironmentL W
.W X
SpecialFolderX e
.e f
Systemf l
)l m
)m n
;n o
uint 
serNum 
= 
$num 
; 
uint 

maxCompLen 
= 
$num 
;  
StringBuilder 
VolLabel "
=# $
new% (
StringBuilder) 6
(6 7
$num7 :
): ;
;; <
UInt32 
VolFlags 
= 
new !
UInt32" (
(( )
)) *
;* +
StringBuilder 
FSName  
=! "
new# &
StringBuilder' 4
(4 5
$num5 8
)8 9
;9 :
strDriveLetter 
+= 
$str #
;# $
long 
Ret 
=  
GetVolumeInformation +
(+ ,
strDriveLetter, :
,: ;
VolLabel< D
,D E
(F G
UInt32G M
)M N
VolLabelN V
.V W
CapacityW _
,_ `
refa d
serNume k
,k l
refm p

maxCompLenq {
,{ |
ref	} Ä
VolFlags
Å â
,
â ä
FSName
ã ë
,
ë í
(
ì î
UInt32
î ö
)
ö õ
FSName
õ °
.
° ¢
Capacity
¢ ™
)
™ ´
;
´ ¨
return 
Convert 
. 
ToString #
(# $
serNum$ *
)* +
;+ ,
} 	
} 
} 